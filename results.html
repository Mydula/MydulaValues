<head>
    <link href="https://fonts.googleapis.com/css?family=Montserrat:300,400,700|Roboto:400,700" rel="stylesheet">
    <link href='style.css' rel='stylesheet' type='text/css'>
    <title>MydulaValues Результаты</title>
    <link href="icon.png" rel="icon" type="x-icon">
    <link href="icon.png" rel="shortcut icon" type="x-icon">
    <meta charset="utf-8">
    <script>
        version = "Test Edition #1" //Remember to update this before making changes to the test itself!
    </script>
</head>
<script src="ideologies.js"
        type="application/javascript">
</script>

<body>
<h1>MydulaValues</h1>
<hr>

<h1>Результаты</h1>

<h2><b>Ось структуры: </b><span class="weight-300" id="f-label"></span></h2>
<div class="axis">
    <img id="img-f" src="value_images/federal.png" height="128pt"/>
    <div class="bar f" id="bar-f"><div class="text-wrapper" id="f"></div></div>
    <div class="bar f2" id="bar-f2"><div class="text-wrapper" id="f2"></div></div>
    <img id="img-f2" src="value_images/unitary.png" height="128pt"/>
</div>
<h2><b>Ось представительства: </b><span class="weight-300" id="d-label"></span></h2>
<div class="axis">
    <img id="img-d" src="value_images/democracy.png" height="128pt"/>
    <div class="bar d" id="bar-d"><div class="text-wrapper" id="d"></div></div>
    <div class="bar d2" id="bar-d2"><div class="text-wrapper" id="d2"></div></div>
    <img id="img-d2" src="value_images/authority.png" height="128pt"/>
</div>
<h2><b>Ось государства: </b><span class="weight-300" id="g-label"></span></h2>
<div class="axis">
    <img id="img-g" src="value_images/security.png" height="128pt"/>
    <div class="bar g" id="bar-g"><div class="text-wrapper" id="g"></div></div>
    <div class="bar g2" id="bar-g2"><div class="text-wrapper" id="g2"></div></div>
    <img id="img-g2" src="value_images/freedom.png" height="128pt"/>
</div>
<h2><b>Ось взаимодействия: </b><span class="weight-300" id="n-label"></span></h2>
<div class="axis">
    <img id="img-n" src="value_images/internationalism.png" height="128pt"/>
    <div class="bar n" id="bar-n"><div class="text-wrapper" id="n"></div></div>
    <div class="bar n2" id="bar-n2"><div class="text-wrapper" id="n2"></div></div>
    <img id="img-n2" src="value_images/nationalism.png" height="128pt"/>
</div>
<h2><b>Ось дипломатии: </b><span class="weight-300" id="m-label"></span></h2>
<div class="axis">
    <img id="img-m" src="value_images/militarist.png" height="128pt"/>
    <div class="bar m" id="bar-m"><div class="text-wrapper" id="m"></div></div>
    <div class="bar m2" id="bar-m2"><div class="text-wrapper" id="m2"></div></div>
    <img id="img-m2" src="value_images/pacifist.png" height="128pt"/>
</div>
<h2><b>Ось иммиграции: </b><span class="weight-300" id="c-label"></span></h2>
<div class="axis">
    <img id="img-c" src="value_images/assimilationist.png" height="128pt"/>
    <div class="bar c" id="bar-i"><div class="text-wrapper" id="c"></div></div>
    <div class="bar c2" id="bar-c2"><div class="text-wrapper" id="c2"></div></div>
    <img id="img-c2" src="value_images/multiculturalist.png" height="128pt"/>
</div>
<h2><b>Ось экономики: </b><span class="weight-300" id="e-label"></span></h2>
<div class="axis">
    <img id="img-e" src="value_images/equality.png" height="128pt"/>
    <div class="bar e" id="bar-e"><div class="text-wrapper" id="e"></div></div>
    <div class="bar e2" id="bar-e2"><div class="text-wrapper" id="e2"></div></div>
    <img id="img-e2" src="value_images/private.png" height="128pt"/>
</div>
<h2><b>Ось регулирования: </b><span class="weight-300" id="r-label"></span></h2>
<div class="axis">
    <img id="img-r" src="value_images/planned.png" height="128pt"/>
    <div class="bar r" id="bar-r"><div class="text-wrapper" id="r"></div></div>
    <div class="bar r2" id="bar-r2"><div class="text-wrapper" id="r2"></div></div>
    <img id="img-r2" src="value_images/markets.png" height="128pt"/>
</div>
<h2><b>Ось глобальности: </b><span class="weight-300" id="i-label"></span></h2>
<div class="axis">
    <img id="img-i" src="value_images/protectionism.png" height="128pt"/>
    <div class="bar i" id="bar-i"><div class="text-wrapper" id="i"></div></div>
    <div class="bar i2" id="bar-i2"><div class="text-wrapper" id="i2"></div></div>
    <img id="img-i2" src="value_images/globalist.png" height="128pt"/>
</div>
<h2><b>Ось мировоззрения: </b><span class="weight-300" id="s-label"></span></h2>
<div class="axis">
    <img id="img-s" src="value_images/secular.png" height="128pt"/>
    <div class="bar s" id="bar-s"><div class="text-wrapper" id="s"></div></div>
    <div class="bar s2" id="bar-s2"><div class="text-wrapper" id="s2"></div></div>
    <img id="img-s2" src="value_images/religious.png" height="128pt"/>
</div>
<h2><b>Ось культуры: </b><span class="weight-300" id="p-label"></span></h2>
<div class="axis">
    <img id="img-p" src="value_images/progress.png" height="128pt"/>
    <div class="bar p" id="bar-p"><div class="text-wrapper" id="p"></div></div>
    <div class="bar p2" id="bar-p2"><div class="text-wrapper" id="p2"></div></div>
    <img id="img-p2" src="value_images/tradition.png" height="128pt"/>
</div>
<h2><b>Ось технологии: </b><span class="weight-300" id="a-label"></span></h2>
<div class="axis">
    <img id="img-a" src="value_images/technology.png" height="128pt"/>
    <div class="bar a" id="bar-a"><div class="text-wrapper" id="a"></div></div>
    <div class="bar a2" id="bar-a2"><div class="text-wrapper" id="a2"></div></div>
    <img id="img-a2" src="value_images/bioconservative.png" height="128pt"/>
</div>
<h2>Ближайшее совпадение: <span class="weight-300" id="ideology-label"></span></h2>
<p>Вы можете отправить эти результаты, скопировав и вставив URL в верхней части страницы,  или скачав изображение ниже, зажав его своим пальцем.</p>
<hr/>
<img id="banner" src="">
<button class="button" onclick="location.href='index.html';">Назад</button>
<br>

<!-- Website visit statistics - no personal information is collected! -->
<!-- Default Statcounter code for 8values-ru https://8values-ru.github.io/ -->
<script type="text/javascript">
    var sc_project=12707281;
    var sc_invisible=1;
    var sc_security="5e2ebfd7";
</script>
<script type="text/javascript"
        src="https://www.statcounter.com/counter/counter.js" async></script>
<noscript><div class="statcounter"><a title="Web Analytics Made Easy -
Statcounter" href="https://statcounter.com/" target="_blank"><img
        class="statcounter" src="https://c.statcounter.com/12707281/0/5e2ebfd7/1/"
        alt="Web Analytics Made Easy - Statcounter"
        referrerPolicy="no-referrer-when-downgrade"></a></div></noscript>
<!-- End of Statcounter Code -->
<script src="https://www.w3counter.com/tracker.js?id=114877"></script>

<script>
    function cacheImages(array)
    {
        if (!cacheImages.list) {
            cacheImages.list = [];
        }
        var list = cacheImages.list;
        for (var i = 0; i < array.length; i++) {
            var img = new Image();
            img.onload = function() {
                var index = list.indexOf(this);
                if (index !== -1) {
                    // remove image from the array once it's loaded
                    // for memory consumption reasons
                    list.splice(index, 1);
                }
            }
            list.push(img);
            img.src = array[i];
        }
    }
    if (/iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream) {
        cacheImages([
            "value_images/federal.png",
            "value_images/unitary.png",
            "value_images/democracy.png",
            "value_images/authority.png",
            "value_images/security.png",
            "value_images/freedom.png",
            "value_images/internationalism.png",
            "value_images/nationalism.png"
            "value_images/militarist.png",
            "value_images/pacifist.png",
            "value_images/assimilationist.png",
            "value_images/multiculturalist.png",
            "value_images/equality.png",
            "value_images/private.png",
            "value_images/planned.png",
            "value_images/markets.png"
            "value_images/protectionism.png",
            "value_images/globalist.png",
            "value_images/secular.png",
            "value_images/religious.png",
            "value_images/progress.png",
            "value_images/tradition.png",
            "value_images/technology.png",
            "value_images/bioconservative.png"
        ]);
    }

    function getQueryVariable(variable) {
        var query = window.location.search.substring(1)
        var vars = query.split("&")
        for (var i = 0; i < vars.length; i++) {
            var pair = vars[i].split("=")
            if (pair[0] == variable) {
                return pair[1]
            }
        }
        return (NaN);
    }

    function setBarValue(name, value) {
        innerel = document.getElementById(name)
        outerel = document.getElementById("bar-" + name)
        outerel.style.width = (value + "%")
        innerel.innerHTML = (value + "%")
        if (innerel.offsetWidth + 20 > outerel.offsetWidth) {
            innerel.style.visibility = "hidden"
        }
    }

    fdrlArray = ["Локализм","Конфедерация","Федерация","Центризм","Централизм","Унитаризм","Космократия"]
    dmcrArray = ["Охлократия","Демократия","Популизм","Центризм","Олигархия","Бюрократия","Автократия"]
    govtArray = ["Тоталитаризм","Авторитаризм","Этатизм","Центризм","Либерализм","Либертарианство","Анархия"]
    natiArray = ["Космополитизм","Интернационализм","Сотрудничество","Нейтрал","Патриотизм","Национализм","Шовинизм"]
    miltArray = ["Терроризм","Агрессия","Милитаризм","Нейтрал","Мир","Пацифизм","Анти-война"]
    clntArray = ["Ксенофобия","Ассимиляция","Монокультурализм","Центризм","Поликультурализм","Мультикультурализм","Плавильный котёл"]
    econArray = ["Коммунизм","Социализм","Велферизм","Смешанная экономика","Экономический либерализм","Капитализм","Социал-дарвинизм"]
    reglArray = ["Плановая экономика","Регулирование","Корпоративизм","Балансирование","Рыночная экономика","Свободный рынок","Laissez-Faire"]
    isolArray = ["Изоляционизм","Партикуляризм","Протекционизм","Умеренный","Универсализм","Глобализм","Мировой федерализм"]
    seclArray = ["Антитеизм","Атеизм","Агностицизм","Светскость","Спиритуализм","Клерикализм","Эзотерика"]
    progArray = ["Социальная революция","Прогрессивизм","Реформизм","Балансирование","Консерватизм","Традиционализм","Политическая реакция"]
    acclArray = ["Технократия","Акселерационизм","Трансгуманизм","Нейтральный","Биоконсерватизм","Децелерационизм","Примитивизм"]

    function setLabel(val, ary) {
        if (val > 100) {
            return ""
        } else if (val > 90) {
            return ary[0]
        } else if (val > 75) {
            return ary[1]
        } else if (val > 60) {
            return ary[2]
        } else if (val >= 40) {
            return ary[3]
        } else if (val >= 25) {
            return ary[4]
        } else if (val >= 10) {
            return ary[5]
        } else if (val >= 0) {
            return ary[6]
        } else {
            return ""
        }
    }

    f = getQueryVariable("f")
    d = getQueryVariable("d")
    g = getQueryVariable("g")
    n = getQueryVariable("n")
    m = getQueryVariable("m")
    c = getQueryVariable("c")
    e = getQueryVariable("e")
    r = getQueryVariable("r")
    i = getQueryVariable("i")
    s = getQueryVariable("s")
    p = getQueryVariable("p")
    a = getQueryVariable("a")
    f2 = (100 - f).toFixed(1)
    d2 = (100 - d).toFixed(1)
    g2 = (100 - g).toFixed(1)
    n2 = (100 - n).toFixed(1)
    m2 = (100 - m).toFixed(1)
    c2 = (100 - c).toFixed(1)
    e2 = (100 - e).toFixed(1)
    r2 = (100 - r).toFixed(1)
    i2 = (100 - i).toFixed(1)
    s2 = (100 - s).toFixed(1)
    p2 = (100 - p).toFixed(1)
    a2 = (100 - a).toFixed(1)

    setBarValue("f", f)
    setBarValue("f2", f2)
    setBarValue("d", d)
    setBarValue("d2", d2)
    setBarValue("g", g)
    setBarValue("g2", g2)
    setBarValue("n", n)
    setBarValue("n2", n2)
    setBarValue("m", m)
    setBarValue("m2", m2)
    setBarValue("c", c)
    setBarValue("c2", c2)
    setBarValue("e", e)
    setBarValue("e2", e2)
    setBarValue("r", r)
    setBarValue("r2", r2)
    setBarValue("i", i)
    setBarValue("i2", i2)
    setBarValue("s", s)
    setBarValue("s2", s2)
    setBarValue("p", p)
    setBarValue("p2", p2)
    setBarValue("a", a)
    setBarValue("a2", a2)

    document.getElementById("f-label").innerHTML = setLabel(f, fdrlArray)
    document.getElementById("d-label").innerHTML = setLabel(d, dmcrArray)
    document.getElementById("g-label").innerHTML = setLabel(g, govtArray)
    document.getElementById("n-label").innerHTML = setLabel(n, natiArray)
    document.getElementById("m-label").innerHTML = setLabel(m, miltArray)
    document.getElementById("c-label").innerHTML = setLabel(c, clntArray)
    document.getElementById("e-label").innerHTML = setLabel(e, econArray)
    document.getElementById("r-label").innerHTML = setLabel(r, reglArray)
    document.getElementById("i-label").innerHTML = setLabel(i, isolArray)
    document.getElementById("s-label").innerHTML = setLabel(s, seclArray)
    document.getElementById("p-label").innerHTML = setLabel(p, progArray)
    document.getElementById("a-label").innerHTML = setLabel(a, acclArray)

    ideology = ""
    ideodist = Infinity
    for (var i = 0; i < ideologies.length; i++) {
        dist = 0
        dist += Math.pow(Math.abs(ideologies[i].stats.fdrl - f), 2)
        dist += Math.pow(Math.abs(ideologies[i].stats.dmcr - d), 2)
        dist += Math.pow(Math.abs(ideologies[i].stats.govt - g), 2)
        dist += Math.pow(Math.abs(ideologies[i].stats.nati - n), 2)
        dist += Math.pow(Math.abs(ideologies[i].stats.milt - m), 2)
        dist += Math.pow(Math.abs(ideologies[i].stats.clnt - c), 2)
        dist += Math.pow(Math.abs(ideologies[i].stats.econ - e), 2)
        dist += Math.pow(Math.abs(ideologies[i].stats.regl - r), 2)
        dist += Math.pow(Math.abs(ideologies[i].stats.isol - i), 2)
        dist += Math.pow(Math.abs(ideologies[i].stats.secl - s), 2)
        dist += Math.pow(Math.abs(ideologies[i].stats.prog - p), 2)
        dist += Math.pow(Math.abs(ideologies[i].stats.accl - a), 2)
        if (dist < ideodist) {
            ideology = ideologies[i].name
            ideodist = dist
        }
    }
    document.getElementById("ideology-label").innerHTML = ideology

    function createImage(ctx, src, x, y, w, h) {
        img = new Image()
        img.src = src
        img.onLoad = function () {
        ctx.drawImage(img, x, y, w, h)
    }

    window.onload = function () {
        var r_r = 2.0 // resize ratio for higher image quality
        var c = document.createElement("canvas")
        var ctx = c.getContext("2d")
        c.width = 800 * r_r;
        c.height = 650 * r_r;
        ctx.fillStyle = "#EEEEEE"
        ctx.fillRect(0, 0, 800 * r_r, 1620 * r_r);
        // Fix for iOS Safari, doesn't draw svg properly
        if (/iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream) {
            createImage(ctx, "value_images/equality.png", 20 * r_r, 170 * r_r, 100 * r_r, 100 * r_r)
            createImage(ctx, "value_images/markets.png", 680 * r_r, 170 * r_r, 100 * r_r, 100 * r_r)
            createImage(ctx, "value_images/nation.png", 20 * r_r, 290 * r_r, 100 * r_r, 100 * r_r)
            createImage(ctx, "value_images/globe.png", 680 * r_r, 290 * r_r, 100 * r_r, 100 * r_r)
            createImage(ctx, "value_images/liberty.png", 20 * r_r, 410 * r_r, 100 * r_r, 100 * r_r)
            createImage(ctx, "value_images/authority.png", 680 * r_r, 410 * r_r, 100 * r_r, 100 * r_r)
            createImage(ctx, "value_images/tradition.png", 20 * r_r, 530 * r_r, 100 * r_r, 100 * r_r)
            createImage(ctx, "value_images/progress.png", 680 * r_r, 530 * r_r, 100 * r_r, 100 * r_r)
        } else {
            img = document.getElementById("img-equality")
            ctx.drawImage(img, 20 * r_r, 170 * r_r, 100 * r_r, 100 * r_r);
            img = document.getElementById("img-wealth")
            ctx.drawImage(img, 680 * r_r, 170 * r_r, 100 * r_r, 100 * r_r)
            img = document.getElementById("img-might")
            ctx.drawImage(img, 20 * r_r, 290 * r_r, 100 * r_r, 100 * r_r)
            img = document.getElementById("img-peace")
            ctx.drawImage(img, 680 * r_r, 290 * r_r, 100 * r_r, 100 * r_r)
            img = document.getElementById("img-liberty")
            ctx.drawImage(img, 20 * r_r, 410 * r_r, 100 * r_r, 100 * r_r)
            img = document.getElementById("img-authority")
            ctx.drawImage(img, 680 * r_r, 410 * r_r, 100 * r_r, 100 * r_r)
            img = document.getElementById("img-tradition")
            ctx.drawImage(img, 20 * r_r, 530 * r_r, 100 * r_r, 100 * r_r)
            img = document.getElementById("img-progress")
            ctx.drawImage(img, 680 * r_r, 530 * r_r, 100 * r_r, 100 * r_r)
        }

		ctx.fillStyle="#222222"
        ctx.fillRect(120 * r_r, 180 * r_r, 560 * r_r, 80 * r_r)
        ctx.fillRect(120 * r_r, 300 * r_r, 560 * r_r, 80 * r_r)
        ctx.fillRect(120 * r_r, 420 * r_r, 560 * r_r, 80 * r_r)
        ctx.fillRect(120 * r_r, 540 * r_r, 560 * r_r, 80 * r_r)
	    ctx.fillRect(120 * r_r, 660 * r_r, 560 * r_r, 80 * r_r)
	    ctx.fillRect(120 * r_r, 780 * r_r, 560 * r_r, 80 * r_r)
	    ctx.fillRect(120 * r_r, 900 * r_r, 560 * r_r, 80 * r_r)
	    ctx.fillRect(120 * r_r, 1020 * r_r, 560 * r_r, 80 * r_r)
	    ctx.fillRect(120 * r_r, 1140 * r_r, 560 * r_r, 80 * r_r)
	    ctx.fillRect(120 * r_r, 1260 * r_r, 560 * r_r, 80 * r_r)
	    ctx.fillRect(120 * r_r, 1380 * r_r, 560 * r_r, 80 * r_r)
	    ctx.fillRect(120 * r_r, 1500 * r_r, 560 * r_r, 80 * r_r)
        ctx.fillStyle = "#f44336"
        ctx.fillRect(120 * r_r, 184 * r_r, 5.6 * r_r * equality - 2, 72 * r_r)
        ctx.fillStyle = "#00897b"
        ctx.fillRect(682 * r_r - 5.6 * wealth * r_r, 184 * r_r, 5.6 * wealth  * r_r - 2, 72 * r_r)
        ctx.fillStyle = "#ff9800"
        ctx.fillRect(120 * r_r, 304 * r_r, 5.6 * r_r * might - 2, 72 * r_r)
        ctx.fillStyle = "#03a9f4"
        ctx.fillRect(682 * r_r - 5.6 * r_r * peace, 304 * r_r, 5.6 * r_r * peace - 2, 72 * r_r)
        ctx.fillStyle = "#ffeb3b"
        ctx.fillRect(120 * r_r, 424 * r_r, 5.6 * r_r * liberty - 2, 72 * r_r)
        ctx.fillStyle = "#3f51b5"
        ctx.fillRect(682 * r_r - 5.6 * r_r * authority, 424 * r_r, 5.6 * r_r * authority - 2, 72 * r_r)
        ctx.fillStyle = "#8bc34a"
        ctx.fillRect(120 * r_r, 544 * r_r, 5.6 * r_r * tradition - 2, 72 * r_r)
        ctx.fillStyle = "#9c27b0"
        ctx.fillRect(682 * r_r - 5.6 * r_r * progress, 544 * r_r, 5.6 * r_r * progress - 2, 72 * r_r)
        ctx.fillStyle = "#222222"
        ctx.font="550 " + 40 * r_r + "px Montserrat"
        ctx.textAlign="left"
        ctx.fillText("MydulaValues", 20 * r_r, 60 * r_r)
        ctx.font= 35 * r_r + "px Montserrat"
        ctx.fillText(ideology, 20 * r_r, 140 * r_r)

        ctx.textAlign="left"
        if (equality  > 30) {ctx.fillText(equality + "%", 130 * r_r, 237.5 * r_r)}
        if (might     > 30) {ctx.fillText(might + "%", 130 * r_r, 357.5 * r_r)}
        if (liberty   > 30) {ctx.fillText(liberty + "%", 130 * r_r, 477.5 * r_r)}
        if (tradition > 30) {ctx.fillText(tradition + "%", 130 * r_r, 597.5 * r_r)}
        ctx.textAlign="right"
        if (wealth    > 30) {ctx.fillText(wealth + "%", 670 * r_r, 237.5 * r_r)}
        if (peace     > 30) {ctx.fillText(peace + "%", 670 * r_r, 357.5 * r_r)}
        if (authority > 30) {ctx.fillText(authority + "%", 670 * r_r, 477.5 * r_r)}
        if (progress  > 30) {ctx.fillText(progress + "%", 670 * r_r, 597.5 * r_r)}

        ctx.font="300 " + 24 * r_r + "px Montserrat"
        ctx.fillText("https://mydula.github.io/MydulaValues", 780 * r_r, 30 * r_r)
        //ctx.fillText(version, 780, 120)
        ctx.font="400 " + 24 * r_r + "px Montserrat"
        ctx.textAlign="center"
        ctx.fillText("Экономическая ось: " + document.getElementById("economic-label").innerHTML, 400 * r_r, 175 * r_r)
        ctx.fillText("Дипломатическая ось: " + document.getElementById("diplomatic-label").innerHTML, 400 * r_r, 295 * r_r)
        ctx.fillText("Гражданская ось: " + document.getElementById("state-label").innerHTML, 400 * r_r, 415 * r_r)
        ctx.fillText("Социальная ось: " + document.getElementById("society-label").innerHTML, 400 * r_r, 535 * r_r)

        document.getElementById("banner").src = c.toDataURL();
    }
</script>
</body>
